# Lumina Note 开发路线图

> 最后更新：2025-06-01

---

## 📊 功能完成度概览

| 类别 | 完成度 | 说明 |
|------|--------|------|
| 核心编辑 | 80% | Markdown、LaTeX、代码高亮、分屏 |
| 文件管理 | 75% | 文件树（全类型）、多标签页、自动保存 |
| 知识管理 | 70% | 反向链接、标签、大纲 |
| 知识图谱 | 60% | 全局图谱、节点交互、圆形边界 |
| AI 功能 | 95% ✨ | Agent 系统、多模型、RAG、实时预览、语音输入 |
| 搜索功能 | 70% | 全文搜索、正则、高亮 |
| 数据库 | 85% ✨ | Dataview 风格 YAML 驱动，表格/看板视图 |

**综合评分：约 70% 的 Obsidian 核心功能 + 独特 AI 能力**

---

## ✅ 已完成功能

### 编辑器
- ✅ Markdown 编辑 + 实时预览（三种模式）
- ✅ LaTeX 数学公式（KaTeX）
- ✅ WikiLinks `[[]]` 点击跳转
- ✅ Callouts `> [!note]` 语法
- ✅ 代码高亮（多语言）
- ✅ 任务列表 `- [ ]`
- ✅ 水平/垂直分屏编辑
- ✅ 本地/远程图片渲染

### 文件管理
- ✅ 文件树浏览
- ✅ 创建/删除/重命名文件
- ✅ 多标签页
- ✅ 自动保存（500ms 防抖）
- ✅ 新窗口打开

### 知识管理
- ✅ 反向链接面板
- ✅ 标签系统 + 标签面板
- ✅ 大纲视图（层级过滤）
- ✅ 全文搜索 + 正则 + 高亮

### 知识图谱
- ✅ 全局图谱（Canvas 渲染）
- ✅ 节点交互（点击跳转、拖拽）
- ✅ 右键菜单（孤立视图）
- ✅ 文件夹着色
- ✅ 圆形软边界（自然聚集效果）

### AI 功能 🤖
- ✅ **多模型支持**：Anthropic、OpenAI、DeepSeek、Moonshot、Groq、OpenRouter、Ollama
- ✅ **Agent 系统**：4 种模式（editor/organizer/researcher/writer）
- ✅ **7 个 Agent 工具**：read_note、edit_note、write_note、list_notes、move_note、search_notes、attempt_completion
- ✅ **RAG 系统**：向量嵌入、SQLite 存储、语义搜索
- ✅ **实时编辑预览**：逐字动画、绿色高亮、滚动跟随
- ✅ **Diff 预览**：接受/拒绝修改
- ✅ **上下文感知**：自动附加当前文件
- ✅ **语音输入 (STT)**：基于 Web Speech API，流式显示 + 静音自动停止 + 录音动画
- ✅ **全屏设置面板**：AI 设置 + Agent 设置 + RAG 设置统一管理
- ✅ **自定义模型**：支持自定义模型 ID 和 Base URL（第三方代理）
- ✅ **智能会话管理**：避免创建重复空白会话

### 数据库（Dataview 风格）✅
- ✅ **YAML frontmatter 驱动**：笔记即数据，双向同步
- ✅ **表格视图组件**：列头编辑、行操作、内联编辑
- ✅ **看板视图组件**：按 Select 列分组、卡片拖拽
- ✅ **7 种列类型 UI**：Text、Number、Select、Multi-select、Date、Checkbox、URL
- ✅ **文件树集成**：数据库图标、点击打开视图

---

## 🚧 待完善功能

| 功能 | 状态 | 说明 |
|------|------|------|
| 文件拖拽 | ⏳ | 从左侧拖到右侧打开 |
| 图片拖拽上传 | ⏳ | 粘贴/拖拽图片 |
| 链接悬浮预览 | ⏳ | 鼠标悬停预览 |
| 模板系统 | ⏳ | 模板变量 |
| 日历视图 | ⏳ | 每日笔记 + 日历导航 |

---

## 🎯 开发路线图

### Phase 1: 核心补全 ✅ 已完成
- ~~反向链接~~ ✅
- ~~标签系统~~ ✅
- ~~大纲视图~~ ✅
- ~~搜索高亮~~ ✅
- ~~分屏编辑~~ ✅
- ~~图片渲染~~ ✅

### Phase 2: AI 系统 ✅ 已完成
- ~~LLM 服务重构~~ ✅（7 个 Provider）
- ~~Agent 系统~~ ✅（4 模式 + 7 工具）
- ~~RAG 向量搜索~~ ✅
- ~~实时编辑预览~~ ✅

### Phase 3: 体验优化（进行中）

**文件拖拽**
- [ ] Sidebar 添加 draggable 支持
- [ ] TabBar 拖放区域
- [ ] SplitEditor 拖放区域
- [ ] 拖拽视觉反馈

**其他优化**
- [ ] 图片拖拽上传
- [ ] 链接悬浮预览
- [ ] 模板系统

### Phase 4: 重点新功能 🎯

#### 1. Dataview 风格数据库（优先级：⭐⭐⭐⭐⭐）✅ 已完成

```
目标：YAML 驱动的可视化数据库，笔记即数据，双向同步
架构：Dataview 风格（笔记 YAML = 真相来源）
```

##### 🎯 核心理念

```
┌─────────────────────────────────────────────────┐
│  笔记 YAML frontmatter  ←──→  数据库视图        │
│         (真相来源)              (展示层)         │
└─────────────────────────────────────────────────┘

- 读取：扫描笔记 YAML → 渲染表格/看板/日历
- 写入：编辑单元格 → 写回笔记 YAML
- 删除笔记 → 数据库自动消失（无残留）
```

##### 📁 存储结构

```
vault/
├── Databases/
│   └── projects.db.json    ← 只存列定义，不存数据
└── Notes/
    ├── 项目A.md            ← 数据在 YAML 里
    └── 项目B.md
```

**笔记示例**：
```markdown
---
db: projects              # 属于哪个数据库
title: 项目A
status: 进行中
priority: 高
due: 2024-12-15
tags: [工作, 重要]
related:                  # Relation 字段
  - "[[项目B]]"
---

# 项目A
正文内容...
```

**数据库定义**（只存结构）：
```json
{
  "id": "projects",
  "name": "项目管理",
  "columns": [
    { "name": "title", "type": "text" },
    { "name": "status", "type": "select", "options": [...] },
    { "name": "priority", "type": "select" },
    { "name": "due", "type": "date" }
  ],
  "views": [
    { "type": "table", "name": "表格" },
    { "type": "kanban", "name": "看板", "groupBy": "status" }
  ]
}
```

##### ✅ 已完成

| 模块 | 状态 |
|------|------|
| 表格视图组件 | ✅ |
| 看板视图组件 | ✅ |
| 7 种列类型 UI | ✅ |
| 内联编辑 | ✅ |
| 文件树集成 | ✅ |

##### ✅ 已完成重构

| 任务 | 状态 |
|------|------|
| YAML 解析器 | ✅ |
| 数据源重构（扫描笔记） | ✅ |
| 双向同步（编辑→写回 YAML） | ✅ |
| 数据库定义（只存列结构） | ✅ |
| 刷新机制 | ✅ |

##### ⏳ 待开发

| 功能 | 工作量 |
|------|--------|
| 日历视图 | 2天 |
| 画廊视图 | 2天 |
| Formula 公式 | 3天 |
| Relation 关联 | 2天 |
| Rollup 汇总 | 2天 |

##### 💪 相比 Notion 的优势

| 优势 | 说明 |
|------|------|
| **纯文本** | 任何编辑器都能改 YAML |
| **Git 友好** | 版本控制只需跟踪 .md |
| **永不过时** | 软件没了数据还在笔记里 |
| **隐私安全** | 数据完全本地 |
| **免费开源** | 无订阅费 |

---

#### 2. PDF 阅读与标注（优先级：⭐⭐⭐⭐）
```
目标：打开 PDF、高亮批注、导出笔记
工作量：2-3 周
技术：react-pdf / pdf.js
存储：vault/LocalData/pdf-annotations/
```

| 阶段 | 内容 | 时间 |
|------|------|------|
| 基础渲染 | 翻页、缩放、目录 | 1 周 |
| 批注功能 | 高亮、下划线、笔记、绘图 | 1.5 周 |
| 批注管理 | 侧边栏、跳转、导出 | 0.5 周 |

---

#### 3. 地图与路线规划（优先级：⭐⭐⭐）
```
目标：地图标记 + 路线规划 + AI 助手集成
工作量：3-4 周
技术：高德地图 JS API + Web 服务 API
存储：vault/LocalData/map-data/
```

| 阶段 | 内容 | 时间 |
|------|------|------|
| 地图基础 | 高德 JS API、POI 搜索 | 1 周 |
| 标记功能 | Pin、描述、照片 | 0.5 周 |
| 路线规划 | 途经点、导航路线、GPX | 1 周 |
| AI 助手 🤖 | `plan_route` Tool、自然语言规划 | 1 周 |
| 笔记关联 | 嵌入地图、双向跳转 | 0.5 周 |

**AI 交互示例**：
```
用户: "帮我规划北京一日游，先去天安门再去故宫"
AI:   "已规划！步行 1.2km，约 15 分钟。还要加其他地方吗？"

用户: "加个王府井，改成打车"
AI:   "已更新！驾车约 20 分钟。"
```

---

### Phase 5: 体验增强
- [ ] 日记功能 - 每日笔记、日历视图
- [ ] 模板系统 - 模板变量、快速插入
- [ ] 主题系统 - CSS 主题
- [ ] 全文索引 - Rust tantivy

### Phase 6: 生态建设（长期）
- [ ] 插件系统架构
- [ ] 笔记分享 - 类 Notion 公开链接

---

## 💡 Lumina Note 差异化优势

| 优势 | 说明 |
|------|------|
| **原生 AI** | 7 个模型提供商、Agent 系统、RAG、实时编辑预览 |
| **轻量技术栈** | Tauri v2 + Rust，比 Electron 更小更快 |
| **本地优先** | 数据完全本地，隐私安全 |
| **完全开源** | MIT 许可，自由修改分发 |

---

## 📈 总结

**当前状态**：功能完整的笔记应用 + 独特 AI 能力

**核心优势**：
- ✅ 完整的 Agent 系统（4 模式 + 7 工具）
- ✅ 多模型支持（7 个 Provider）
- ✅ RAG 语义搜索
- ✅ 实时编辑预览动画
- ✅ 语音输入（流式显示 + 自动停止）

**下一步重点**：
1. 重构数据库为 Dataview 风格（YAML 驱动）
2. 完善数据库功能（日历、画廊、公式、关联）
3. PDF 阅读标注

---

## 🔍 Lumina Note vs Notion vs Obsidian Dataview

### 架构对比

| 方面 | Notion | Obsidian Dataview | Lumina Note (新) |
|------|--------|-------------------|------------------|
| 数据存储 | 云端数据库 | 笔记 YAML | 笔记 YAML ✅ |
| 真相来源 | 数据库 | 笔记 | 笔记 ✅ |
| 离线可用 | ❌ 需网络 | ✅ 完全离线 | ✅ 完全离线 |
| 可视化编辑 | ✅ 优秀 | ❌ 只读查询 | ✅ 双向同步 |
| 纯文本友好 | ❌ | ✅ | ✅ |
| Git 友好 | ❌ | ✅ | ✅ |

### 功能对比表

| 功能 | Notion | Dataview | Lumina Note |
|------|--------|----------|-------------|
| **视图** |
| 表格视图 | ✅ | ✅ 只读 | ✅ 可编辑 |
| 看板视图 | ✅ | ❌ | ✅ |
| 日历视图 | ✅ | ✅ 只读 | ⏳ |
| 画廊视图 | ✅ | ❌ | ⏳ |
| **编辑** |
| 可视化编辑 | ✅ | ❌ | ✅ |
| 双向同步 | — | — | ✅ |
| **数据** |
| 纯文本 | ❌ | ✅ | ✅ |
| 版本控制 | ❌ | ✅ | ✅ |
| 永不过时 | ❌ | ✅ | ✅ |

### 完成度评估

```
当前状态：核心功能完成 ✅

UI 层（表格+看板+列类型）: 100% ✅
数据层（YAML 驱动）: 100% ✅
高级视图（日历+画廊）: 0% ⏳
高级列类型（公式+关联）: 0% ⏳
```

### 下一步优先级

| 优先级 | 任务 | 工作量 |
|--------|------|--------|
| ⭐⭐⭐⭐ | 日历视图 | 2天 |
| ⭐⭐⭐⭐ | 画廊视图 | 2天 |
| ⭐⭐⭐ | Relation 关联 | 2天 |
| ⭐⭐⭐ | Formula 公式 | 3天 |

### 我们的独特优势 💪

| 优势 | 说明 |
|------|------|
| **笔记即数据** | 数据在 YAML，永不分散 |
| **双向同步** | 可视化编辑 + 自动写回（Dataview 做不到） |
| **纯文本友好** | 任何编辑器都能改 |
| **Git 友好** | 版本控制只需跟踪 .md |
| **永不过时** | 软件没了数据还在笔记里 |
| **AI 集成** | 可与 Agent 系统结合 |
| **隐私安全** | 完全本地，不上传 |
| **免费开源** | 无订阅费 |
